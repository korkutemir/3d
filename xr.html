<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script type="module"> 

        import * as THREE from "https://cdn.skypack.dev/three@0.136.0";
import {
  OrbitControls
} from "https://cdn.skypack.dev/three@0.136.0/examples/jsm/controls/OrbitControls.js";
import {
  CSS3DRenderer,
  CSS3DObject
} from 'https://cdn.skypack.dev/three@0.136.0/examples/jsm/renderers/CSS3DRenderer.js';

        window.onload=function() {
            document.getElementById("button").onclick=function() {
              if ('xr' in navigator) {
  navigator.xr.requestSession('immersive-vr', {
    requiredFeatures: ['local-floor', 'bounded-floor'],
    optionalFeatures: ['hand-tracking']
  })
  .then((session) => {
    // The session has been successfully started

    // Create a Three.js scene
    const scene = new THREE.Scene();

    // Create a Three.js camera
    const camera = new THREE.PerspectiveCamera(
      75,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );

    // Create a Three.js renderer
    const renderer = new THREE.WebGLRenderer({ xrCompatible: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Set up the renderer for WebXR
    renderer.xr.enabled = true;
    renderer.xr.setReferenceSpaceType('local-floor');

    // Render the scene with the camera
    function animate() {
      renderer.setAnimationLoop(() => {
        renderer.render(scene, camera);
      });
    }
    animate();

    // Add any VR-related tasks or VR content to the scene

    // End the VR session when necessary
    session.addEventListener('end', () => {
      // Cleanup tasks or actions to be performed when the VR session ends

      // Stop the animation loop
      renderer.setAnimationLoop(null);

      // Remove the renderer element from the DOM
      document.body.removeChild(renderer.domElement);
    });
  })
  .catch((error) => {
    // Handle any errors that occurred during session initialization
    console.error('Failed to start VR session:', error);
  });
} else {
  console.error('WebXR or Cardboard is not supported.');
  // Handle the lack of WebXR or Cardboard support gracefully
}
            }
        }
        </script>
        <button id="button">VR</button>
</body>
</html>